<head>
  <meta charset="UTF-8">
</head>
<body></body>
<script type="module">
import { iter } from '../iter.js'
import { State, get } from '../state.js'
import { div, h3, button } from './bindings.js'

const items = [
  { name: 'Crown', view: 'ðŸ‘‘' },
  { name: 'Kimono', view: 'ðŸ‘˜' },
  { name: 'Cute ribbon', view: 'ðŸŽ€' },
  { name: 'Sweet dress', view: 'ðŸ‘—' },
  { name: 'A pair of sneakers', view: 'ðŸ‘Ÿ' },
  { name: 'Weird looking necklace', view: 'ðŸ“¿' },
]

const randomItem = () =>
  items[items.length * Math.random() | 0]

const suit = new State([], {
  key: 'name',
  actions: {
    pick(v) {
      const amount = Math.random() * 5 | 0 + 1
      const newsuit = Array(amount).fill().map(randomItem)
      return [...new Set(newsuit)] // remove duplicates
    },
  },
  views: {
    button: v => v.length > 0 ? 'Something else' : 'Pick',
  },
})

const app =
  div(null)
    (h3('What to wear'))
    (button(get`${suit.button}`)
      .on('click', suit.pick)
    )
    (iter(suit)(q =>
      div('.suit-item')(get`${q.name} ${q.view}`)
    ))

app(document.body)
</script>
